{"expireTime":9007200858552848000,"key":"transformer-remark-markdown-html-a2ffd8f9a86b7d1ec4c89d089fcef8f4-gatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-videogatsby-remark-copy-linked-filesgatsby-remark-autolink-headersgatsby-remark-prismjs-","val":"<h1 id=\"interactive-dashboard-with-multiple-charts\" style=\"position:relative;\"><a href=\"#interactive-dashboard-with-multiple-charts\" aria-label=\"interactive dashboard with multiple charts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Interactive Dashboard with Multiple Charts</h1>\n<p>In the previous part, we've created an analytical backend and a basic dashboard with the first chart. Now we're going to expand the dashboard so it provides the view of key performance indicators of our e-commerce company.</p>\n<h2 id=\"custom-date-range\" style=\"position:relative;\"><a href=\"#custom-date-range\" aria-label=\"custom date range permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Custom Date Range</h2>\n<p>As the first step, we'll let users change the date range of the existing chart.</p>\n<p>For that, we'll need to make a change to the <code class=\"language-text\">dashboard-page.component.ts</code> file: </p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">// ...\n\nexport class DashboardPageComponent implements OnInit {\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> private query = new BehaviorSubject({\n<span class=\"token prefix unchanged\"> </span>   measures: [\"Orders.count\"],\n<span class=\"token prefix unchanged\"> </span>   timeDimensions: [{ dimension: \"Orders.createdAt\", granularity: \"month\", dateRange: \"This year\" }],\n<span class=\"token prefix unchanged\"> </span>   dimensions: [\"Orders.status\"],\n<span class=\"token prefix unchanged\"> </span>   filters: [{ dimension: \"Orders.status\", operator: \"notEquals\", values: [\"completed\"] }]\n<span class=\"token prefix unchanged\"> </span> });\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  changeDateRange = (value) => {\n<span class=\"token prefix inserted\">+</span>    this.query.next({\n<span class=\"token prefix inserted\">+</span>      ...this.query.value,\n<span class=\"token prefix inserted\">+</span>      timeDimensions: [{ dimension: \"Orders.createdAt\", granularity: \"month\", dateRange: value }]\n<span class=\"token prefix inserted\">+</span>    });\n<span class=\"token prefix inserted\">+</span>  };\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> cards = [];\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> ngOnInit() {\n<span class=\"token prefix unchanged\"> </span>   this.query.subscribe(data => {\n<span class=\"token prefix unchanged\"> </span>     this.cards[0] = {\n<span class=\"token prefix unchanged\"> </span>       chart: \"bar\", cols: 2, rows: 1,\n<span class=\"token prefix unchanged\"> </span>       query: data\n<span class=\"token prefix unchanged\"> </span>     };\n<span class=\"token prefix unchanged\"> </span>   });\n<span class=\"token prefix unchanged\"> </span> }\n</span>}</code></pre></div>\n<p>And another one to the <code class=\"language-text\">dashobard-page.component.html</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-arrow deleted\"><span class=\"token prefix deleted\"><</span>div class=\"grid-container\">\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> &lt;h1 class=\"mat-h1\">Dashboard&lt;/h1>\n<span class=\"token prefix unchanged\"> </span> &lt;mat-grid-list cols=\"3\" rowHeight=\"450px\">\n<span class=\"token prefix unchanged\"> </span>   &lt;mat-grid-tile *ngFor=\"let card of cards\" [colspan]=\"card.cols\" [rowspan]=\"card.rows\">\n<span class=\"token prefix unchanged\"> </span>     &lt;mat-card class=\"dashboard-card\">\n<span class=\"token prefix unchanged\"> </span>       &lt;mat-card-header>\n<span class=\"token prefix unchanged\"> </span>         &lt;mat-card-title>\n<span class=\"token prefix unchanged\"> </span>           &lt;button mat-icon-button class=\"more-button\" [matMenuTriggerFor]=\"menu\" aria-label=\"Toggle menu\">\n<span class=\"token prefix unchanged\"> </span>             &lt;mat-icon>more_vert&lt;/mat-icon>\n<span class=\"token prefix unchanged\"> </span>           &lt;/button>\n<span class=\"token prefix unchanged\"> </span>           &lt;mat-menu #menu=\"matMenu\" xPosition=\"before\">\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>            &lt;button mat-menu-item  (click)=\"changeDateRange('This year')\">This year&lt;/button>\n<span class=\"token prefix inserted\">+</span>            &lt;button mat-menu-item  (click)=\"changeDateRange('Last year')\">Last year&lt;/button>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>           &lt;/mat-menu>\n<span class=\"token prefix unchanged\"> </span>         &lt;/mat-card-title>\n<span class=\"token prefix unchanged\"> </span>       &lt;/mat-card-header>\n<span class=\"token prefix unchanged\"> </span>       &lt;mat-card-content class=\"dashboard-card-content\">\n<span class=\"token prefix unchanged\"> </span>         &lt;div>\n<span class=\"token prefix unchanged\"> </span>           &lt;app-bar-chart [query]=\"card.query\" *ngIf=\"card.chart === 'bar'\">&lt;/app-bar-chart>\n<span class=\"token prefix unchanged\"> </span>         &lt;/div>\n<span class=\"token prefix unchanged\"> </span>       &lt;/mat-card-content>\n<span class=\"token prefix unchanged\"> </span>     &lt;/mat-card>\n<span class=\"token prefix unchanged\"> </span>   &lt;/mat-grid-tile>\n<span class=\"token prefix unchanged\"> </span> &lt;/mat-grid-list>\n</span><span class=\"token deleted-arrow deleted\"><span class=\"token prefix deleted\"><</span>/div></span></code></pre></div>\n<p>Well done! ðŸŽ‰ Here's what our dashboard application looks like:</p>\n<p><img src=\"/images/image-48.png\"></p>\n<h2 id=\"kpi-chart\" style=\"position:relative;\"><a href=\"#kpi-chart\" aria-label=\"kpi chart permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>KPI Chart</h2>\n<p>The KPI chart can be used to display business indicators that provide information about the current performance of our e-commerce company. The chart will consist of a grid of tiles, where each tile will display a single numeric KPI value for a certain category.</p>\n<p>First, let's add the <code class=\"language-text\">countUp</code> package to add the count-up animation to the values on the KPI chart. Run the following command in the dashboard-app folder:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> i ngx-countup @angular/material/progress-bar</code></pre></div>\n<p>We weed to import these modules:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span> import { CountUpModule } from 'ngx-countup';\n<span class=\"token prefix inserted\">+</span> import { MatProgressBarModule } from '@angular/material/progress-bar'\n</span>\n@NgModule({\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> imports: [\n</span>\n//    ...\n\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    CountUpModule,\n<span class=\"token prefix inserted\">+</span>    MatProgressBarModule\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> ],\n<span class=\"token prefix unchanged\"> </span> ...\n</span>})</code></pre></div>\n<p>Second, let's add an array of cards we're going to display to the <code class=\"language-text\">dashboard-page.component.ts</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">export class DashboardPageComponent implements OnInit {\n\n// ...\n\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  public KPICards = [\n<span class=\"token prefix inserted\">+</span>    {\n<span class=\"token prefix inserted\">+</span>      title: 'ORDERS',\n<span class=\"token prefix inserted\">+</span>      query: { measures: ['Orders.count'] },\n<span class=\"token prefix inserted\">+</span>      difference: 'Orders',\n<span class=\"token prefix inserted\">+</span>      duration: 1.25,\n<span class=\"token prefix inserted\">+</span>    },\n<span class=\"token prefix inserted\">+</span>    {\n<span class=\"token prefix inserted\">+</span>      title: 'TOTAL USERS',\n<span class=\"token prefix inserted\">+</span>      query: { measures: ['Users.count'] },\n<span class=\"token prefix inserted\">+</span>      difference: 'Users',\n<span class=\"token prefix inserted\">+</span>      duration: 1.5,\n<span class=\"token prefix inserted\">+</span>    },\n<span class=\"token prefix inserted\">+</span>    {\n<span class=\"token prefix inserted\">+</span>      title: 'COMPLETED ORDERS',\n<span class=\"token prefix inserted\">+</span>      query: { measures: ['Orders.percentOfCompletedOrders'] },\n<span class=\"token prefix inserted\">+</span>      progress: true,\n<span class=\"token prefix inserted\">+</span>      duration: 1.75,\n<span class=\"token prefix inserted\">+</span>    },\n<span class=\"token prefix inserted\">+</span>    {\n<span class=\"token prefix inserted\">+</span>      title: 'TOTAL PROFIT',\n<span class=\"token prefix inserted\">+</span>      query: { measures: ['LineItems.price'] },\n<span class=\"token prefix inserted\">+</span>      duration: 2.25,\n<span class=\"token prefix inserted\">+</span>    },\n<span class=\"token prefix inserted\">+</span>  ];\n</span>\n// ...\n\n}</code></pre></div>\n<p>The next step is create the KPI Card component. Run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ng generate component kpi-card</code></pre></div>\n<p>Edit this component's code:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Input<span class=\"token punctuation\">,</span> OnInit <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@angular/core\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CubejsClient <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@cubejs-client/ngx\"</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token operator\">:</span> <span class=\"token string\">'app-kpi-card'</span><span class=\"token punctuation\">,</span>\n  templateUrl<span class=\"token operator\">:</span> <span class=\"token string\">'./kpi-card.component.html'</span><span class=\"token punctuation\">,</span>\n  styleUrls<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'./kpi-card.component.scss'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KpiCardComponent</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OnInit</span> <span class=\"token punctuation\">{</span>\n  @<span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> query<span class=\"token operator\">:</span> object<span class=\"token punctuation\">;</span>\n  @<span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> title<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n  @<span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> duration<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  @<span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> progress<span class=\"token operator\">:</span> boolean<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">private</span> cubejs<span class=\"token operator\">:</span>CubejsClient</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">public</span> result <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> postfix <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> prefix <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cubejs<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>\n      <span class=\"token parameter\">resultSet</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">series</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">s</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> s<span class=\"token punctuation\">[</span><span class=\"token string\">'series'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> measureKey <span class=\"token operator\">=</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">seriesNames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> annotations <span class=\"token operator\">=</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">tableColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tableColumn</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> tableColumn<span class=\"token punctuation\">.</span>key <span class=\"token operator\">===</span> measureKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> format <span class=\"token operator\">=</span> annotations<span class=\"token punctuation\">.</span>format <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>annotations<span class=\"token punctuation\">.</span>meta <span class=\"token operator\">&amp;&amp;</span> annotations<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">.</span>format<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>format <span class=\"token operator\">===</span> <span class=\"token string\">'percent'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>postfix <span class=\"token operator\">=</span> <span class=\"token string\">'%'</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>format <span class=\"token operator\">===</span> <span class=\"token string\">'currency'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>prefix <span class=\"token operator\">=</span> <span class=\"token string\">'$'</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token parameter\">err</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'HTTP Error'</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And the component's template:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dashboard-card<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card-header</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dashboard-card__header<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card-title</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kpi-title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{title}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card-title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card-header</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card-content</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dashboard-card-content kpi-result<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span>{{prefix}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">[countUp]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>result<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[options]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{duration: duration}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span>{{postfix}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-progress-bar</span> <span class=\"token attr-name\">[color]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">'</span>primary<span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kpi-progress<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>progress<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{{result}}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-progress-bar</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card-content</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>The final step is to add this component to our dashboard page. To do so, open <code class=\"language-text\">dashboard-page.component.html</code> and replace the code:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>grid-container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kpi-wrap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-grid-list</span> <span class=\"token attr-name\">cols</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>4<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rowHeight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>131px<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-grid-tile</span> <span class=\"token attr-name\">*ngFor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>let card of KPICards<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[colspan]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[rowspan]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>app-kpi-card</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>kpi-card<span class=\"token punctuation\">\"</span></span>\n                      <span class=\"token attr-name\">[query]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.query<span class=\"token punctuation\">\"</span></span>\n                      <span class=\"token attr-name\">[title]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.title<span class=\"token punctuation\">\"</span></span>\n                      <span class=\"token attr-name\">[duration]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.duration<span class=\"token punctuation\">\"</span></span>\n                      <span class=\"token attr-name\">[progress]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.progress<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>app-kpi-card</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-grid-tile</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-grid-list</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-grid-list</span> <span class=\"token attr-name\">cols</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>5<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rowHeight</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>510px<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-grid-tile</span> <span class=\"token attr-name\">*ngFor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>let card of cards<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[colspan]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.cols<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[rowspan]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.rows<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dashboard-card<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card-header</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dashboard-card__header<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card-title</span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span><span class=\"token punctuation\">></span></span>Last sales<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">mat-icon-button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>more-button<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[matMenuTriggerFor]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>menu<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">aria-label</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Toggle menu<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-icon</span><span class=\"token punctuation\">></span></span>more_vert<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-icon</span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-menu</span> <span class=\"token attr-name\">#menu</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>matMenu<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">xPosition</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>before<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">mat-menu-item</span>  <span class=\"token attr-name\">(click)</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>changeDateRange(<span class=\"token punctuation\">'</span>This year<span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>This year<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">mat-menu-item</span>  <span class=\"token attr-name\">(click)</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>changeDateRange(<span class=\"token punctuation\">'</span>Last year<span class=\"token punctuation\">'</span>)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Last year<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-menu</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card-title</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card-header</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-card-content</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dashboard-card-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>app-bar-chart</span> <span class=\"token attr-name\">[query]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.query<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">*ngIf</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card.chart === <span class=\"token punctuation\">'</span>bar<span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>app-bar-chart</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card-content</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-card</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-grid-tile</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-grid-list</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>The only thing left is to adjust the Cube.js schema. While doing it, we'll learn an important aspect of Cube.js...</p>\n<p><strong>Let's learn how to create custom measures in the data schema and display their values.</strong> In the e-commerce business, it's crucial to know the share of completed orders. To enable our users to monitor this metric, we'll want to display it on the KPI chart. So, we will modify the data schema by <a href=\"https://cube.dev/docs/measures/\">adding a custom measure</a> (<code class=\"language-text\">percentOfCompletedOrders</code>) which will calculate the share based on another measure (<code class=\"language-text\">completedCount</code>).</p>\n<p>Let's customize the \"Orders\" schema. Open the <code class=\"language-text\">schema/Orders.js</code> file in the root folder of the Cube.js project and make the following changes: </p>\n<ul>\n<li>add the <code class=\"language-text\">completedCount</code> measure</li>\n<li>add the <code class=\"language-text\">percentOfCompletedOrders</code> measure</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">cube(`Orders`, {\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> sql: `SELECT * FROM public.orders`,\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> // ...\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> measures: {\n<span class=\"token prefix unchanged\"> </span>   count: {\n<span class=\"token prefix unchanged\"> </span>     type: `count`,\n<span class=\"token prefix unchanged\"> </span>     drillMembers: [id, createdAt]\n<span class=\"token prefix unchanged\"> </span>   },\n<span class=\"token prefix unchanged\"> </span>   number: {\n<span class=\"token prefix unchanged\"> </span>     sql: `number`,\n<span class=\"token prefix unchanged\"> </span>     type: `sum`\n<span class=\"token prefix unchanged\"> </span>   },\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    completedCount: {\n<span class=\"token prefix inserted\">+</span>      sql: `id`,\n<span class=\"token prefix inserted\">+</span>      type: `count`,\n<span class=\"token prefix inserted\">+</span>      filters: [\n<span class=\"token prefix inserted\">+</span>        { sql: `${CUBE}.status = 'completed'` }\n<span class=\"token prefix inserted\">+</span>      ]\n<span class=\"token prefix inserted\">+</span>    },\n<span class=\"token prefix inserted\">+</span>    percentOfCompletedOrders: {\n<span class=\"token prefix inserted\">+</span>      sql: `${completedCount} * 100.0 / ${count}`,\n<span class=\"token prefix inserted\">+</span>      type: `number`,\n<span class=\"token prefix inserted\">+</span>      format: `percent`\n<span class=\"token prefix inserted\">+</span>    }\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> },\n</span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> // ...</span></code></pre></div>\n<p>Great! ðŸŽ‰ Now our dashboard has a row of nice and informative KPI metrics:</p>\n<p><img src=\"/images/image-18.png\"></p>\n<h2 id=\"doughnut-chart\" style=\"position:relative;\"><a href=\"#doughnut-chart\" aria-label=\"doughnut chart permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Doughnut Chart</h2>\n<p>Now, using the KPI chart, our users are able to monitor the share of completed orders. However, there are two more kinds of orders: \"processed\" orders (ones that were acknowledged but not yet shipped) and \"shipped\" orders (essentially, ones that were taken for delivery but not yet completed).</p>\n<p>To enable our users to monitor all these kinds of orders, we'll want to add one final chart to our dashboard. It's best to use the Doughnut chart for that, because it's quite useful to visualize the distribution of a certain metric between several states (e.g., all kinds of orders).</p>\n<p>First, let's create the <code class=\"language-text\">DoughnutChart</code> component. Run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ng generate component doughnut-chart</code></pre></div>\n<p>Then edit the <code class=\"language-text\">doughnut-chart.component.ts</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Input<span class=\"token punctuation\">,</span> OnInit <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@angular/core\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> CubejsClient <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@cubejs-client/ngx\"</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  selector<span class=\"token operator\">:</span> <span class=\"token string\">\"app-doughnut-chart\"</span><span class=\"token punctuation\">,</span>\n  templateUrl<span class=\"token operator\">:</span> <span class=\"token string\">\"./doughnut-chart.component.html\"</span><span class=\"token punctuation\">,</span>\n  styleUrls<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"./doughnut-chart.component.scss\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DoughnutChartComponent</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OnInit</span> <span class=\"token punctuation\">{</span>\n  @<span class=\"token function\">Input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> query<span class=\"token operator\">:</span> Object<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> barChartOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    legend<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      display<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    responsive<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    maintainAspectRatio<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    cutoutPercentage<span class=\"token operator\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\n    layout<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> padding<span class=\"token operator\">:</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    tooltips<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      enabled<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      mode<span class=\"token operator\">:</span> <span class=\"token string\">\"index\"</span><span class=\"token punctuation\">,</span>\n      intersect<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      borderWidth<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      borderColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#eeeeee\"</span><span class=\"token punctuation\">,</span>\n      backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#ffffff\"</span><span class=\"token punctuation\">,</span>\n      titleFontColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#43436B\"</span><span class=\"token punctuation\">,</span>\n      bodyFontColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#A1A1B5\"</span><span class=\"token punctuation\">,</span>\n      footerFontColor<span class=\"token operator\">:</span> <span class=\"token string\">\"#A1A1B5\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> barChartLabels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> barChartType <span class=\"token operator\">=</span> <span class=\"token string\">\"doughnut\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> barChartLegend <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> barChartData <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> labels <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">private</span> cubejs<span class=\"token operator\">:</span> CubejsClient</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cubejs<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>\n      <span class=\"token parameter\">resultSet</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> <span class=\"token constant\">COLORS_SERIES</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"#FF6492\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#F3F3FB\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#FFA2BE\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>barChartLabels <span class=\"token operator\">=</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">chartPivot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>category<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>barChartData <span class=\"token operator\">=</span> resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">series</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">s</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          label<span class=\"token operator\">:</span> s<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n          data<span class=\"token operator\">:</span> s<span class=\"token punctuation\">.</span>series<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          backgroundColor<span class=\"token operator\">:</span> <span class=\"token constant\">COLORS_SERIES</span><span class=\"token punctuation\">,</span>\n          hoverBackgroundColor<span class=\"token operator\">:</span> <span class=\"token constant\">COLORS_SERIES</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        resultSet<span class=\"token punctuation\">.</span><span class=\"token function\">series</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">s</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>labels <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>series<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>series<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sum<span class=\"token punctuation\">,</span> current</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> sum<span class=\"token punctuation\">.</span>value <span class=\"token operator\">?</span> sum<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+</span> current<span class=\"token punctuation\">.</span>value <span class=\"token operator\">:</span> sum <span class=\"token operator\">+</span> current<span class=\"token punctuation\">.</span>value\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token parameter\">err</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HTTP Error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And the template in the <code class=\"language-text\">doughnut-chart.component.html</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">baseChart</span>\n          <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>215<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">[datasets]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>barChartData<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">[labels]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>barChartLabels<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">[options]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>barChartOptions<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">[legend]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>barChartLegend<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">[chartType]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>barChartType<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>canvas</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-grid-list</span> <span class=\"token attr-name\">cols</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>mat-grid-tile</span> <span class=\"token attr-name\">*ngFor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>let card of labels<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[colspan]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[rowspan]</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>doughnut-label<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{card.category}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>doughnut-number<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{((card.value/value) * 100).toFixed(1)}}%<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-grid-tile</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>mat-grid-list</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>The next step is to add this card to the <code class=\"language-text\">dashboard-page.component.ts</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">export class DashboardPageComponent implements OnInit {\n\n// ...\n\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>  private doughnutQuery = new BehaviorSubject({\n<span class=\"token prefix inserted\">+</span>    measures: ['Orders.count'],\n<span class=\"token prefix inserted\">+</span>    timeDimensions: [\n<span class=\"token prefix inserted\">+</span>      {\n<span class=\"token prefix inserted\">+</span>        dimension: 'Orders.createdAt',\n<span class=\"token prefix inserted\">+</span>      },\n<span class=\"token prefix inserted\">+</span>    ],\n<span class=\"token prefix inserted\">+</span>    filters: [],\n<span class=\"token prefix inserted\">+</span>    dimensions: ['Orders.status'],\n<span class=\"token prefix inserted\">+</span>  });\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>\n<span class=\"token prefix unchanged\"> </span> ngOnInit() {\n<span class=\"token prefix unchanged\"> </span>   ...\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>    this.doughnutQuery.subscribe(data => {\n<span class=\"token prefix inserted\">+</span>      this.cards[1] = {\n<span class=\"token prefix inserted\">+</span>        hasDatePick: false,\n<span class=\"token prefix inserted\">+</span>        title: 'Users by Device',\n<span class=\"token prefix inserted\">+</span>        chart: \"doughnut\", cols: 2, rows: 1,\n<span class=\"token prefix inserted\">+</span>        query: data\n<span class=\"token prefix inserted\">+</span>      };\n<span class=\"token prefix inserted\">+</span>    });\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span> }\n</span>}</code></pre></div>\n<p>And the last step is to use this template in the <code class=\"language-text\">dashboard-page.component.html</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-arrow deleted\"><span class=\"token prefix deleted\"><</span>div class=\"grid-container\">\n</span>\n// ...\n\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>   &lt;mat-grid-list cols=\"5\" rowHeight=\"510px\">\n<span class=\"token prefix unchanged\"> </span>     &lt;mat-grid-tile *ngFor=\"let card of cards\" [colspan]=\"card.cols\" [rowspan]=\"card.rows\">\n<span class=\"token prefix unchanged\"> </span>       &lt;mat-card class=\"dashboard-card\">\n<span class=\"token prefix unchanged\"> </span>         &lt;mat-card-header class=\"dashboard-card__header\">\n<span class=\"token prefix unchanged\"> </span>           &lt;mat-card-title>\n<span class=\"token prefix unchanged\"> </span>             &lt;h3>{{card.title}}&lt;/h3>\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>             &lt;div *ngIf=\"card.hasDatePick\">\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>               &lt;button mat-icon-button class=\"more-button\" [matMenuTriggerFor]=\"menu\" aria-label=\"Toggle menu\">\n<span class=\"token prefix unchanged\"> </span>                 &lt;mat-icon>more_vert&lt;/mat-icon>\n<span class=\"token prefix unchanged\"> </span>               &lt;/button>\n<span class=\"token prefix unchanged\"> </span>               &lt;mat-menu #menu=\"matMenu\" xPosition=\"before\">\n<span class=\"token prefix unchanged\"> </span>                 &lt;button mat-menu-item  (click)=\"changeDateRange('This year')\">This year&lt;/button>\n<span class=\"token prefix unchanged\"> </span>                 &lt;button mat-menu-item  (click)=\"changeDateRange('Last year')\">Last year&lt;/button>\n<span class=\"token prefix unchanged\"> </span>               &lt;/mat-menu>\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>             &lt;/div>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>           &lt;/mat-card-title>\n<span class=\"token prefix unchanged\"> </span>         &lt;/mat-card-header>\n<span class=\"token prefix unchanged\"> </span>         &lt;mat-card-content class=\"dashboard-card-content\">\n<span class=\"token prefix unchanged\"> </span>           &lt;div>\n<span class=\"token prefix unchanged\"> </span>             &lt;app-bar-chart [query]=\"card.query\" *ngIf=\"card.chart === 'bar'\">&lt;/app-bar-chart>\n</span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span>              &lt;app-doughnut-chart [query]=\"card.query\" *ngIf=\"card.chart === 'doughnut'\">&lt;/app-doughnut-chart>\n</span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span>           &lt;/div>\n<span class=\"token prefix unchanged\"> </span>         &lt;/mat-card-content>\n<span class=\"token prefix unchanged\"> </span>       &lt;/mat-card>\n<span class=\"token prefix unchanged\"> </span>     &lt;/mat-grid-tile>\n<span class=\"token prefix unchanged\"> </span>   &lt;/mat-grid-list>\n<span class=\"token prefix unchanged\"> </span> &lt;/div>\n</span><span class=\"token deleted-arrow deleted\"><span class=\"token prefix deleted\"><</span>/div></span></code></pre></div>\n<p>Awesome! ðŸŽ‰ Now the first page of our dashboard is complete:</p>\n<p><img src=\"/images/image-53.png\"></p>"}